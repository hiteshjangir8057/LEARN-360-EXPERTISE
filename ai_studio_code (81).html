<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Text Backup to JSON</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f0f2f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a1a1a; margin-bottom: 5px; }
        .sub-text { text-align: center; color: #666; font-size: 13px; margin-bottom: 20px; }
        
        /* Text Area Style */
        textarea { 
            width: 100%; 
            height: 250px; 
            padding: 15px; 
            border: 2px solid #e1e1e1; 
            border-radius: 8px; 
            font-size: 16px; 
            line-height: 1.5;
            resize: vertical;
            outline: none;
            box-sizing: border-box; /* Fix padding issue */
        }
        textarea:focus { border-color: #007bff; }

        /* Button Style */
        button { 
            width: 100%; 
            padding: 12px; 
            background-color: #007bff; 
            color: white; 
            border: none; 
            border-radius: 6px; 
            font-size: 16px; 
            font-weight: bold; 
            cursor: pointer; 
            margin-top: 15px; 
            transition: background 0.3s;
        }
        button:hover { background-color: #0056b3; }

        /* Status Bar */
        #status { 
            margin-top: 15px; 
            text-align: center; 
            font-weight: 500; 
            padding: 12px; 
            border-radius: 6px; 
            font-size: 14px;
        }
        .status-idle { color: #666; background-color: #f8f9fa; border: 1px solid #ddd; }
        .status-working { color: #856404; background-color: #fff3cd; border: 1px solid #ffeeba; }
        .status-success { color: #155724; background-color: #d4edda; border: 1px solid #c3e6cb; }
        .status-error { color: #721c24; background-color: #f8d7da; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>

<div class="container">
    <h2>üìù Personal Cloud Notes</h2>
    <p class="sub-text">Connected to: hiteshjangir8057 / LEARN-360-EXPERTISE</p>
    
    <!-- ‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™ ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç (Plain Text) -->
    <textarea id="userText" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§ï‡•Å‡§õ ‡§≠‡•Ä ‡§≤‡§ø‡§ñ‡•á‡§Ç... ‡§Ø‡§π ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ JSON ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§"></textarea>
    
    <button onclick="saveData()">‚òÅÔ∏è Backup Text Now</button>

    <div id="status" class="status-idle">Ready to sync...</div>
</div>

<script>
    // --- SETTINGS ---
    const OWNER = "hiteshjangir8057";
    const REPO = "LEARN-360-EXPERTISE";
    const FILE_PATH = "my_notes.json"; // JSON ‡§´‡§æ‡§á‡§≤ ‡§ï‡§æ ‡§®‡§æ‡§Æ
    
    // üëá ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ GitHub Token ‡§°‡§æ‡§≤‡•á‡§Ç
    const TOKEN = "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"; 

    let currentSHA = null;
    const textArea = document.getElementById("userText");
    const statusDiv = document.getElementById("status");

    function setStatus(msg, type) {
        statusDiv.innerText = msg;
        statusDiv.className = `status-${type}`;
    }

    // Unicode Support (Hindi/Emoji ‡§ï‡•á ‡§≤‡§ø‡§è)
    function utf8_to_b64(str) {
        return window.btoa(unescape(encodeURIComponent(str)));
    }
    function b64_to_utf8(str) {
        return decodeURIComponent(escape(window.atob(str)));
    }

    // 1. DATA LOAD (GitHub ‡§∏‡•á JSON ‡§≤‡§æ‡§ï‡§∞ ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¶‡§ø‡§ñ‡§æ‡§®‡§æ)
    async function loadData() {
        setStatus("GitHub ‡§∏‡•á ‡§°‡•á‡§ü‡§æ ‡§ö‡•á‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...", "working");
        
        const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${FILE_PATH}`;

        try {
            const response = await fetch(url, {
                headers: { "Authorization": `token ${TOKEN}` }
            });

            if (response.status === 404) {
                setStatus("‡§ï‡•ã‡§à ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§ ‡§®‡§Ø‡§æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç‡•§", "idle");
                currentSHA = null;
                return;
            }

            const data = await response.json();
            currentSHA = data.sha;
            
            // JSON ‡§ï‡•ã ‡§™‡§æ‡§∞‡•ç‡§∏ ‡§ï‡§∞‡§ï‡•á ‡§∏‡§ø‡§∞‡•ç‡§´ text_content ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç
            const jsonContent = JSON.parse(b64_to_utf8(data.content));
            
            // Textarea ‡§Æ‡•á‡§Ç ‡§∏‡§ø‡§∞‡•ç‡§´ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç (JSON ‡§ï‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç)
            if(jsonContent.text_content) {
                textArea.value = jsonContent.text_content;
            }
            
            setStatus(`Last Synced: ${jsonContent.last_updated}`, "success");

        } catch (error) {
            console.error(error);
            setStatus("‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§ó‡§≤‡§§‡•Ä ‡§π‡•Å‡§à‡•§ ‡§ü‡•ã‡§ï‡§® ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§", "error");
        }
    }

    // 2. DATA SAVE (‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•ã JSON ‡§Æ‡•á‡§Ç ‡§≤‡§™‡•á‡§ü ‡§ï‡§∞ ‡§∏‡•á‡§µ ‡§ï‡§∞‡§®‡§æ)
    async function saveData() {
        const text = textArea.value;
        
        if(!text.trim()) {
            setStatus("‡§ñ‡§æ‡§≤‡•Ä ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§ó‡§æ‡•§ ‡§ï‡•Å‡§õ ‡§≤‡§ø‡§ñ‡•á‡§Ç‡•§", "error");
            return;
        }

        setStatus("Data Backup ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à... ‡§ï‡•É‡§™‡§Ø‡§æ ‡§∞‡•Å‡§ï‡•á‡§Ç", "working");

        // ‡§π‡§Æ ‡§Ü‡§™‡§ï‡•á ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§ï‡•ã JSON ‡§∏‡•ç‡§ü‡•ç‡§∞‡§ï‡•ç‡§ö‡§∞ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç
        const dataToSave = {
            last_updated: new Date().toLocaleString(), // ‡§§‡§æ‡§∞‡•Ä‡§ñ ‡§î‡§∞ ‡§∏‡§Æ‡§Ø
            text_content: text // ‡§Ü‡§™‡§ï‡§æ ‡§≤‡§ø‡§ñ‡§æ ‡§π‡•Å‡§Ü ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü
        };

        const jsonString = JSON.stringify(dataToSave, null, 4); // JSON ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•ã
        const encodedContent = utf8_to_b64(jsonString); // Base64 ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡•ã

        const url = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${FILE_PATH}`;
        
        const bodyData = {
            message: "Updated notes via Website",
            content: encodedContent
        };

        if (currentSHA) {
            bodyData.sha = currentSHA;
        }

        try {
            const response = await fetch(url, {
                method: "PUT",
                headers: {
                    "Authorization": `token ${TOKEN}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(bodyData)
            });

            if (!response.ok) throw new Error("Save Error");

            const result = await response.json();
            currentSHA = result.content.sha;
            setStatus("‚úÖ Data Backup Successful! (JSON ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§Ø‡§æ)", "success");

        } catch (error) {
            console.error(error);
            setStatus("‚ùå ‡§¨‡•à‡§ï‡§Ö‡§™ ‡§´‡•á‡§≤ ‡§π‡•ã ‡§ó‡§Ø‡§æ‡•§ ‡§ï‡§Ç‡§∏‡•ã‡§≤ ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§", "error");
        }
    }

    // ‡§™‡•á‡§ú ‡§ñ‡•Å‡§≤‡§§‡•á ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç
    window.onload = loadData;

</script>

</body>
</html>